/*! http://www.imgix.com imgix.js - v2.2.1 - 2016-04-03 */

(function(){function a(){Object.freeze||(Object.freeze=function(b){return b}),Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments.length>=2?arguments[1]:void 0,f=0;f<c;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(null==this)throw new TypeError(" this is null or not defined");var f=Object(this),g=f.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=new Array(g),e=0;e<g;){var h,i;e in f&&(h=f[e],i=a.call(c,h,e,f),d[e]=i),e++}return d}),document.querySelectorAll||(document.querySelectorAll=function(a){var d,b=document.createElement("style"),c=[];for(document.documentElement.firstChild.appendChild(b),document._qsa=[],b.styleSheet.cssText=a+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0),b.parentNode.removeChild(b);document._qsa.length;)d=document._qsa.shift(),d.style.removeAttribute("x-qsa"),c.push(d);return document._qsa=null,c}),document.querySelector||(document.querySelector=function(a){var b=document.querySelectorAll(a);return b.length?b[0]:null}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var g,h,f=[];for(g in e)a.call(e,g)&&f.push(g);if(b)for(h=0;h<d;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),!("getComputedStyle"in window)&&(window.getComputedStyle=function(){function a(b,c,d,e){var i,f=c[d],g=parseFloat(f),h=f.split(/\d/)[0];return e=null!=e?e:/%|em/.test(h)&&b.parentElement?a(b.parentElement,b.parentElement.currentStyle,"fontSize",null):16,i="fontSize"==d?e:/width/i.test(d)?b.clientWidth:b.clientHeight,"em"==h?g*e:"in"==h?96*g:"pt"==h?96*g/72:"%"==h?g/100*i:g}function b(a,b){var c="border"==b?"Width":"",d=b+"Top"+c,e=b+"Right"+c,f=b+"Bottom"+c,g=b+"Left"+c;a[b]=(a[d]==a[e]==a[f]==a[g]?[a[d]]:a[d]==a[f]&&a[g]==a[e]?[a[d],a[e]]:a[g]==a[e]?[a[d],a[e],a[f]]:[a[d],a[e],a[f],a[g]]).join(" ")}function c(c){var d=c.currentStyle,e=this,f=a(c,d,"fontSize",null);for(property in d)/width|height|margin.|padding.|border.+W/.test(property)&&"auto"!==e[property]?e[property]=a(c,d,property,f)+"px":"styleFloat"===property?e.float=d[property]:e[property]=d[property];return b(e,"margin"),b(e,"padding"),b(e,"border"),e.fontSize=f+"px",e}function d(a){return new c(a)}return c.prototype={constructor:c,getPropertyPriority:function(){},getPropertyValue:function(a){return this[a]||""},item:function(){},removeProperty:function(){},setProperty:function(){},getPropertyCSSValue:function(){}},d}(window))}function g(){return f}"undefined"!=typeof window&&a();var b=this,c={version:"2.2.1"};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=c),exports.imgix=c):b.imgix=c;var d="imgix-usable";c.isImageElement=function(a){return a&&a.tagName&&"img"===a.tagName.toLowerCase()},c.setElementImageAfterLoad=function(a,b,d){var e=new Image;e.onload=function(){c.setElementImage(a,b),"function"==typeof d&&d(a,b)},a.hasAttribute("crossorigin")&&e.setAttribute("crossorigin",a.getAttribute("crossorigin")),e.src=b},c.setElementImage=function(a,b){if(!a)return!1;if(c.isImageElement(a))return a.src!==b&&(a.src=b),!0;var d=c.getBackgroundImage(a);return d!==b&&(d?(a.style.cssText=a.style.cssText.replace(d,b),!0):(document.addEventListener?a.style.backgroundImage="url("+b+")":a.style.cssText="background-image:url("+b+")",!0))},c.getEmptyImage=function(){return c.versionifyUrl("https://assets.imgix.net/pixel.gif")},c.getElementImage=function(a){return c.isImageElement(a)?a.src:c.getBackgroundImage(a)},c.getBackgroundImage=function(a){var c,d,b=/\burl\s*\(\s*["']?([^"'\r\n,]+)["']?\s*\)/gi;return window.getComputedStyle?c=window.getComputedStyle(a):document.documentElement.currentStyle&&(c=a.currentStyle),c&&c.backgroundImage||(c=a.style),d=b.exec(c.backgroundImage),d&&d.length>1?d[1]:""},c.getElementsWithImages=function(){return c.markElementsWithImages(),document.querySelectorAll("."+d)},c.hasImage=function(a){var b=a.style.cssText?a.style.cssText.toLowerCase():a.style.cssText;return a&&(c.isImageElement(a)||b.indexOf("background-image")!==-1)},c.markElementsWithImages=function(){for(var a=document.getElementsByTagName("*"),b=0,d=a.length;b<d;b++)c.hasImage(a[b])&&c.setImgixClass(a[b])},c.hasClass=function(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>-1},c.setImgixClass=function(a){if(c.hasClass(a,d))return c.getImgixClass(a);var b=c.getXPathClass(c.getElementTreeXPath(a));return a.classList.add(b),a.classList.add(d),c.getImgixClass(a)},c.getImgixClass=function(a){if(c.hasClass(a,d))return a.className.match(/imgix-el-[^\s]+/)[0]},c.getXPathClass=function(a){var b;return b=a?c.hashCode(a):(new Date).getTime().toString(36),"imgix-el-"+b},c.getElementImageSize=function(a){var b=0,d=0;return c.isImageElement(a)?(b=a.naturalWidth,d=a.naturalHeight):(b=c.helpers.extractInt(c.getCssProperty(a,"width")),d=c.helpers.extractInt(c.getCssProperty(a,"height"))),{width:b,height:d}},c.getCssPropertyById=function(a,b){var d=document.getElementById(a);return c.helpers.getElementCssProperty(d,b)},c.getCssProperty=function(a,b){return c.helpers.getElementCssProperty(a,b)},c.getCssPropertyBySelector=function(a,b){var d=document.querySelector(a);return c.helpers.getElementCssProperty(d,b)},c.instanceOfImgixURL=function(a){return a&&"[object imgixURL]"===a.toString()},c.setGradientOnElement=function(a,b,d){var e=[];if("undefined"==typeof d)e=["transparent","transparent"];else{var f=c.hexToRGB(d);"rgba"===f.slice(0,4)?(e.push(f),e.push(c.applyAlphaToRGB(f,0))):(e.push(c.applyAlphaToRGB(f,.5)),e.push(c.applyAlphaToRGB(f,0)))}for(var g=["-ms-linear-gradient(top, "+e[0]+" 0%, "+e[1]+" 100%),-ms-linear-gradient(bottom left, "+b[2]+" 0%,"+b[4]+" 25%, "+b[6]+" 50%, "+b[8]+" 75%,"+b[10]+" 100%)","-webkit-gradient(linear, 50% 0%, 50% 100%, color-stop(0%, "+e[1]+"), color-stop(100%, "+e[0]+")),-webkit-gradient(linear, 0% 100%, 100% 0%, color-stop(0%, "+b[2]+"), color-stop(25%, "+b[4]+"), color-stop(50%, "+b[6]+"), color-stop(75%, "+b[7]+"), color-stop(100%, "+b[10]+"))","-webkit-linear-gradient(top, "+e[0]+", "+e[1]+" 100%),-webkit-linear-gradient(bottom left, "+b[2]+", "+b[4]+", "+b[6]+","+b[8]+")","-moz-linear-gradient(top, "+e[0]+", "+e[1]+" ),-moz-linear-gradient(bottom left, "+b[2]+", "+b[4]+", "+b[6]+","+b[8]+")","-o-linear-gradient(top, "+e[0]+","+e[1]+"),-o-linear-gradient(bottom left, "+b[2]+", "+b[4]+", "+b[6]+","+b[8]+")","linear-gradient(top, "+e[0]+","+e[1]+"),linear-gradient(bottom left, "+b[2]+", "+b[4]+", "+b[6]+","+b[8]+")"],h=0;h<g.length;h++)a.style.backgroundImage=g[h]},c.isDef=function(a){return"undefined"!=typeof a},c.hashCode=function(a){var b,c,d=2166136261;for(b=0,c=a.length;b<c;b++)d^=a.charCodeAt(b),d+=(d<<1)+(d<<4)+(d<<7)+(d<<8)+(d<<24);return("0000000"+(d>>>0).toString(16)).substr(-8)},c.helpers={debouncer:function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};window.clearTimeout(c),c=window.setTimeout(f,b)}},throttler:function(a,b){var c;return function(){var f,d=this,e=arguments;c||(f=function(){c=null,a.apply(d,e)},c=window.setTimeout(f,b))}},urlParser:function(){function a(a){return!isNaN(parseFloat(a))&&isFinite(a)}return function(b,c){var d=c||window.location.toString();if(!b)return d;b=b.toString(),"//"===d.substring(0,2)?d="http:"+d:1===d.split("://").length&&(d="http://"+d),c=d.split("/");var e={auth:""},f=c[2].split("@");1===f.length?f=f[0].split(":"):(e.auth=f[0],f=f[1].split(":")),e.protocol=c[0],e.hostname=f[0],e.port=f[1]||("https"===e.protocol.split(":")[0].toLowerCase()?"443":"80"),e.pathname=(c.length>3?"/":"")+c.slice(3,c.length).join("/").split("?")[0].split("#")[0];var g=e.pathname;"/"===g.charAt(g.length-1)&&(g=g.substring(0,g.length-1));var h=e.hostname,i=h.split("."),j=g.split("/");if("hostname"===b)return h;if("domain"===b)return/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test(h)?h:i.slice(-2).join(".");if("sub"===b)return i.slice(0,i.length-2).join(".");if("port"===b)return e.port;if("protocol"===b)return e.protocol.split(":")[0];if("auth"===b)return e.auth;if("user"===b)return e.auth.split(":")[0];if("pass"===b)return e.auth.split(":")[1]||"";if("path"===b)return e.pathname;if("."===b.charAt(0)){if(b=b.substring(1),a(b))return b=parseInt(b,10),i[b<0?i.length+b:b-1]||""}else{if(a(b))return b=parseInt(b,10),j[b<0?j.length+b:b]||"";if("file"===b)return j.slice(-1)[0];if("filename"===b)return j.slice(-1)[0].split(".")[0];if("fileext"===b)return j.slice(-1)[0].split(".")[1]||"";if("?"===b.charAt(0)||"#"===b.charAt(0)){var k=d,l=null;if("?"===b.charAt(0)?k=(k.split("?")[1]||"").split("#")[0]:"#"===b.charAt(0)&&(k=k.split("#")[1]||""),!b.charAt(1))return k;b=b.substring(1),k=k.split("&");for(var m=0,n=k.length;m<n;m++)if(l=k[m].split("="),l[0]===b)return l[1]||"";return null}}return""}}(),mergeObject:function(){for(var d,a={},b=0,c=arguments.length;b<c;b++)for(d in arguments[b])arguments[b].hasOwnProperty(d)&&(a[d]=arguments[b][d]);return a},pixelRound:function(a,b){return Math.ceil(a/b)*b},isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},getWindowDPR:function(){var a=window.devicePixelRatio?window.devicePixelRatio:1;if(a%1!==0){var b=a.toString();b=b.split(".")[1],a=b.length>1&&"0"!==b.slice(1,2)?a.toFixed(2):a.toFixed(1)}return a},getWindowWidth:function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)||1024},getWindowHeight:function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)||768},getImgSrc:function(a){return a.getAttribute("data-src")||a.getAttribute("src")},calculateElementSize:function(a){var b={width:a.offsetWidth,height:a.offsetHeight};if(null===a.parentNode||a===document.body)return b.width=this.getWindowWidth(),b.height=this.getWindowHeight(),b;if(0!==b.width||0!==b.height)return a.alt&&!a.fluid?(a.fluid=!0,this.calculateElementSize(a.parentNode)):b;var c,d,e={},f={position:"absolute",visibility:"hidden",display:"block"};for(d in f)f.hasOwnProperty(d)&&(e[d]=a.style[d],a.style[d]=f[d]);c={width:a.offsetWidth,height:a.offsetHeight};for(d in f)f.hasOwnProperty(d)&&(a.style[d]=e[d]);return 0===c.width||0===c.height?this.calculateElementSize(a.parentNode):c},isReallyObject:function(a){return a&&"object"==typeof a&&"[object Object]"===a.toString()},isFluidSet:function(a){return a&&"object"==typeof a&&"[object FluidSet]"===a.toString()},extractInt:function(a){return void 0===a?0:"number"==typeof a?a:parseInt(a.replace(/\D/g,""),10)||0},camelize:function(a){return a.replace(/[-_\s]+(.)?/g,function(a,b){return b?b.toUpperCase():""})},getElementCssProperty:function(a,b){return window.getComputedStyle?window.getComputedStyle(a,null).getPropertyValue(b):a&&a.style&&b?a.style[this.camelize(b)]:""},matchesSelector:function(a,b){var c=(a.parentNode||document).querySelectorAll(b);return Array.prototype.slice.call(c).indexOf(a)>-1},warn:function(a){window.console&&window.console.warn(a)}},c.URL=function(a,b){this._autoUpdateSel=null,this._autoUpdateCallback=null,a&&"//"===a.slice(0,2)&&window&&window.location&&(a=window.location.protocol+a),this.setUrl(a),"object"==typeof b&&this.setParams(b),this.paramAliases={}},c.URL.prototype.attachGradientTo=function(a,b,d){this.getColors(16,function(e){if(e&&e.length<9)return c.helpers.warn("not enough colors to create a gradient"),void(d&&"function"==typeof d&&d(!1));if("string"==typeof a){var f=document.querySelectorAll(a);if(f&&f.length>0)for(var g=0;g<f.length;g++)c.setGradientOnElement(f[g],e,b)}else c.setGradientOnElement(a,e,b);d&&"function"==typeof d&&d(!0)})},c.URL.prototype.attachImageTo=function(a,b){if("string"==typeof a){var d=document.querySelectorAll(a);if(d&&d.length>0)for(var e=0;e<d.length;e++)c.setElementImageAfterLoad(d[e],this.getUrl(),b)}else c.setElementImageAfterLoad(a,this.getUrl(),b)},c.createParamString=function(){return new c.URL("")},c.updateVersion={};var e={};c.URL.prototype.getColors=function(a,b){function h(a){var c,d,b=[];if(a&&a.colors){for(c=0;c<a.colors.length;c++)d=[Math.round(255*a.colors[c].red),Math.round(255*a.colors[c].green),Math.round(255*a.colors[c].blue)],b.push("rgb("+d.join(", ")+")");return b}}function i(){var a=new XMLHttpRequest;a.onreadystatechange=function(){var c;4===a.readyState&&(c=200===a.status?JSON.parse(a.response):{colors:[{red:1,green:1,blue:1}]},e[g]=h(c),b(e[g]))},a.open("get",g,!0),a.send()}var g,d=10,f=new c.URL(this.getUrl());if("function"==typeof a)if("number"==typeof b){var j=b;b=a,a=j}else b=a,a=d;f.setParams({palette:"json",colors:a}),g=f.getUrl(),e.hasOwnProperty(g)?b&&b(e[g]):i()},c.URL.prototype._handleAutoUpdate=function(){function g(b){return e===a._autoUpdateSel&&b===c.updateVersion[e]}function h(h,i){i in f||(f[i]=[],function(){var j=new Image,k=c.updateVersion[e],l=(new Date).getTime();j.onload=j.onerror=function(){if(g(k))for(var e=0;e<f[i].length;e++)if(c.setElementImage(f[i][e],i),d++,"function"==typeof a._autoUpdateCallback){var h={element:f[i][e],isComplete:d===b,percentComplete:d/b*100,totalComplete:d,loadTime:(new Date).getTime()-l,total:b};a._autoUpdateCallback(h)}},h.hasAttribute("crossorigin")&&j.setAttribute("crossorigin",h.getAttribute("crossorigin")),j.src=i}()),f[i].push(h)}function i(b){var e=c.getElementImage(b),f=e;e&&e.indexOf("?")!==-1&&(f=e.split("?")[0]),a.getBaseUrl()?h(b,a.getUrl()):f&&a.getQueryString()?h(b,f+"?"+a.getQueryString()):d++}var a=this,b=0,d=0,e=this._autoUpdateSel,f={};if(c.isDef(c.updateVersion[e])?c.updateVersion[e]++:c.updateVersion[e]=1,null!==this._autoUpdateSel){var j=document.querySelectorAll(this._autoUpdateSel);if(b=j.length,j&&1===b)i(j[0]);else for(var k=0;k<b;k++)i(j[k])}},c.URL.prototype.autoUpdateImg=function(a,b){this._autoUpdateSel=a,this._autoUpdateCallback=b,this._handleAutoUpdate()},c.URL.prototype.setUrl=function(a){a&&"string"==typeof a&&0!==a.length||(a=c.getEmptyImage()),this.urlParts=c.parseUrl(a)},c.URL.prototype.setURL=function(a){return this.setUrl(a)},c.URL.prototype.getURL=function(){return this.getUrl()},c.URL.prototype.toString=function(){return"[object imgixURL]"},c.URL.prototype.getUrl=function(){var a=c.buildUrl(this.urlParts);return a&&0!==a.length?a:c.getEmptyImage()},c.URL.prototype.removeParam=function(a){this.urlParts.paramValues.hasOwnProperty(a)&&(delete this.urlParts.paramValues[a],this.urlParts.params=Object.keys(this.urlParts.paramValues))},c.URL.prototype.clearThenSetParams=function(a){this.clearParams(!1),this.setParams(a)},c.URL.prototype.clearParams=function(a){a=!c.isDef(a)||a;for(var b in this.urlParts.paramValues)this.urlParts.paramValues.hasOwnProperty(b)&&this.removeParam(b);a&&this._handleAutoUpdate()},c.URL.prototype.setParams=function(a,b){if(c.instanceOfImgixURL(a))return void c.helpers.warn("setParams warning: dictionary of imgix params expectd. imgix URL instance passed instead");for(var d in a)a.hasOwnProperty(d)&&this.setParam(d,a[d],b,!0);this._handleAutoUpdate()},c.URL.prototype.setParam=function(a,b,d,e){return a=a.toLowerCase(),d=!c.isDef(d)||d,e=!!c.isDef(e)&&e,"col"!==a&&"colorize"!==a&&"blend"!==a&&"mono"!==a&&"monochrome"!==a||"rgb"===b.slice(0,3)&&(b=c.rgbToHex(b)),!d&&this.urlParts.paramValues[a]?this:c.isDef(b)&&null!==b&&0!==b.length?(this.urlParts.params.indexOf(a)===-1&&this.urlParts.params.push(a),decodeURIComponent(b)===b&&(b=encodeURIComponent(b)),this.urlParts.paramValues[a]=String(b),e||this._handleAutoUpdate(),this):(this.removeParam(a),this)},c.URL.prototype.getParam=function(a){if("mark"===a||"mask"===a){var b=this.urlParts.paramValues[a];return decodeURIComponent(b)!==b?decodeURIComponent(b):b}return this.urlParts.paramValues[a]},c.URL.prototype.getParams=function(){return this.urlParts.paramValues?this.urlParts.paramValues:{}},c.URL.prototype.getBaseUrl=function(){var a=this.getUrl();return a.indexOf("?")!==-1&&(a=this.getUrl().split("?")[0]),a!==window.location.href?a:""},c.URL.prototype.getQueryString=function(){var a=this.getUrl();return a.indexOf("?")!==-1?this.getUrl().split("?")[1]:""},c.parseUrl=function(a){for(var b=["protocol","hostname","port","path","?","#","hostname"],d=["protocol","hostname","port","pathname","search","hash","host"],e={},f=0;f<d.length;f++)e[d[f]]=c.helpers.urlParser(b[f],a);var g=e.search;if(e.paramValues={},e.params=[],e.baseUrl=a.split("?")[0],g&&g.length>0){"?"===g[0]&&(g=g.substr(1,g.length));for(var h=g.split("&"),i=0;i<h.length;i++){var j=h[i].split("=");j[0]&&j[0].length&&"s"!==j[0]&&(e.paramValues[j[0]]=2===j.length?j[1]:"",e.params.indexOf(j[0])===-1&&e.params.push(j[0]))}}return e},c.buildUrl=function(a){var b=a.protocol+"://"+a.host;if(null!==a.port&&"80"!==a.port&&"443"!==a.port&&(b+=":"+a.port),b+=a.pathname,c.versionifyUrl(a),a.params.length>0){a.params=a.params.map(function(a){return a.toLowerCase()}),a.params=a.params.filter(function(a,b,c){return jQuery(c).index(a)===b}),a.params=a.params.sort(function(a,b){return a<b?-1:a>b?1:0});for(var d=[],e=0;e<a.params.length;e++)a.paramValues[a.params[e]].length>0&&d.push(a.params[e]+"="+a.paramValues[a.params[e]]);b.indexOf("?")!==-1&&(b=b.split("?")[0]),b+="?"+d.join("&")}return b},c.versionifyUrl=function(a){return"string"==typeof a?c.versionifyStringUrl(a):c.versionifyParsedUrl(a)},c.versionifyStringUrl=function(a){var d,e,b="ixjsv";return d=a.split("?"),e=d[0]+"?"+b+"="+c.version,d[1]&&(e+="&"+d[1]),e},c.versionifyParsedUrl=function(a){var b="ixjsv";return a.paramValues[b]||a.params.push(b),a.paramValues[b]=c.version,a};var f={fluidClass:"imgix-fluid",updateOnResize:!0,updateOnResizeDown:!1,updateOnPinchZoom:!1,highDPRAutoScaleQuality:!0,onChangeParamOverride:null,autoInsertCSSBestPractices:!1,fitImgTagToContainerWidth:!0,fitImgTagToContainerHeight:!1,ignoreDPR:!1,pixelStep:10,debounce:200,lazyLoad:!1,lazyLoadColor:null,lazyLoadOffsetVertical:20,lazyLoadOffsetHorizontal:20,lazyLoadScrollContainers:[window],throttle:200,maxHeight:5e3,maxWidth:5e3,onLoad:null};c.FluidSet=function(a){c.helpers.isReallyObject(a)?this.options=c.helpers.mergeObject(g(),a):this.options=c.helpers.mergeObject(g(),{}),this.lazyLoadOffsets={t:Math.max(this.options.lazyLoadOffsetVertical,0),b:Math.max(this.options.lazyLoadOffsetVertical,0),l:Math.max(this.options.lazyLoadOffsetHorizontal,0),r:Math.max(this.options.lazyLoadOffsetHorizontal,0)},this.namespace=Math.random().toString(36).substring(7),this.windowResizeEventBound=!1,this.windowScrollEventBound=!1,this.windowLastWidth=0,this.windowLastHeight=0},c.FluidSet.prototype.updateSrc=function(a,b){if(a.hasAttribute("src")&&""===a.getAttribute("src")&&a.setAttribute("src",c.getEmptyImage()),a.offsetWidth||a.offsetHeight||a.getClientRects().length){var d=this.getImgDetails(a,b||1),e=d.url,f=d.width,g=d.height;if(this.options.lazyLoad){var h=a.getBoundingClientRect(),i={left:0-this.lazyLoadOffsets.l,top:0-this.lazyLoadOffsets.t,bottom:(window.innerHeight||document.documentElement.clientHeight)+this.lazyLoadOffsets.b,right:(window.innerWidth||document.documentElement.clientWidth)+this.lazyLoadOffsets.r};if(h.top>i.bottom||h.left>i.right||h.top+g<i.top||h.left+f<i.left){if(!a.fluidLazyColored&&this.options.lazyLoadColor){a.fluidLazyColored=1;var j=this,k=typeof this.options.lazyLoadColor,l=new c.URL(c.helpers.getImgSrc(a));l.getColors(16,function(b){if(!b)return void c.helpers.warn("No colors found for",l.getURL(),"for element",a);var d=null;"boolean"===k?d=b[0]:"number"===k&&j.options.lazyLoadColor<b.length?d=b[j.options.lazyLoadColor]:"function"===k&&(d=j.options.lazyLoadColor(a,b)),null!==d&&(c.isImageElement(a)&&a.parentNode&&"body"!==a.parentNode.tagName.toLowerCase()?a.parentNode.style.backgroundColor=d:a.style.backgroundColor=d)})}return}}if(a.lastWidth=a.lastWidth||0,a.lastHeight=a.lastHeight||0,!(this.options.updateOnResizeDown===!1&&a.lastWidth>=f&&a.lastHeight>=g)){a.fluidUpdateCount||(a.fluidUpdateCount=0);var m=function(){};this.options.onLoad&&"function"==typeof this.options.onLoad&&(m=this.options.onLoad);var n=function(a,b){a.fluidUpdateCount=parseInt(a.fluidUpdateCount,10)+1,m(a,b)};c.setElementImageAfterLoad(a,e,n),a.lastWidth=f,a.lastHeight=g}}},c.FluidSet.prototype.getImgDetails=function(a,b){if(a){var d=c.helpers.getWindowDPR(),e=this.options.pixelStep,f=c.helpers.calculateElementSize(c.isImageElement(a)?a.parentNode:a),g=c.helpers.pixelRound(f.width*b,e),h=c.helpers.pixelRound(f.height*b,e);a.url||(a.url=new c.URL(c.helpers.getImgSrc(a))),a.url.setParams({h:"",w:""}),g=Math.min(g,this.options.maxWidth),h=Math.min(h,this.options.maxHeight),1===d||this.options.ignoreDPR||a.url.setParam("dpr",d),this.options.highDPRAutoScaleQuality&&d>1&&a.url.setParam("q",Math.min(Math.max(parseInt(100/d,10),30),75)),this.options.fitImgTagToContainerHeight&&this.options.fitImgTagToContainerWidth&&a.url.setParam("fit","crop"),"crop"===a.url.getParam("fit")?(h>0&&(!c.isImageElement(a)||c.isImageElement(a)&&this.options.fitImgTagToContainerHeight)&&a.url.setParam("h",h),g>0&&(!c.isImageElement(a)||c.isImageElement(a)&&this.options.fitImgTagToContainerWidth)&&a.url.setParam("w",g)):h<=g?a.url.setParam("w",g):a.url.setParam("h",h),!c.isImageElement(a)&&this.options.autoInsertCSSBestPractices&&a.style&&(a.style.backgroundRepeat="no-repeat",a.style.backgroundSize="cover",a.style.backgroundPosition="50% 50%");var i={};null!==this.options.onChangeParamOverride&&"function"==typeof this.options.onChangeParamOverride&&(i=this.options.onChangeParamOverride(g,h,a.url.getParams(),a));for(var j in i)i.hasOwnProperty(j)&&a.url.setParam(j,i[j]);return{url:a.url.getURL(),width:g,height:h}}},c.FluidSet.prototype.toString=function(){return"[object FluidSet]"},c.FluidSet.prototype.reload=function(){c.fluid(this),this.windowLastWidth=c.helpers.getWindowWidth(),this.windowLastHeight=c.helpers.getWindowHeight()},c.FluidSet.prototype.attachGestureEvent=function(a){var b=this;a.addEventListener&&!a.listenerAttached&&(a.addEventListener("gestureend",function(a){b.updateSrc(this,a.scale)},!1),a.addEventListener("gesturechange",function(){b.updateSrc(this)},!1),a.listenerAttached=!0)};var h={},i={};c.FluidSet.prototype.attachScrollListener=function(){var a=this;h[this.namespace]=c.helpers.throttler(function(){a.reload()},this.options.throttle);var b,d;document.addEventListener?(b="addEventListener",d="scroll"):(b="attachEvent",d="onscroll");for(var e=0;e<this.options.lazyLoadScrollContainers.length;e++)this.options.lazyLoadScrollContainers[e][b](d,h[this.namespace],!1);this.windowScrollEventBound=!0},c.FluidSet.prototype.attachWindowResizer=function(){var a=this;i[this.namespace]=c.helpers.debouncer(function(){this.windowLastWidth===c.helpers.getWindowWidth()&&this.windowLastHeight===c.helpers.getWindowHeight()||a.reload()},this.options.debounce),window.addEventListener?window.addEventListener("resize",i[this.namespace],!1):window.attachEvent&&window.attachEvent("onresize",i[this.namespace]),this.windowResizeEventBound=!0},c.fluid=function(){var a,b;if(arguments.length>0&&1===arguments[0].nodeType?(b=arguments[0],a=arguments[1]):a=arguments[0],null!==a){var d,e;if(c.helpers.isReallyObject(a)){for(var f=Object.keys(a),h=Object.keys(g()),i=0;i<f.length;i++)h.indexOf(f[i])===-1&&c.helpers.warn("'"+f[i]+"' is not a valid imgix.fluid config option. See https://github.com/imgix/imgix.js/blob/master/docs/api.md#imgix.fluid for a list of valid options.");d=c.helpers.mergeObject(g(),a),e=new c.FluidSet(d),a=null}else c.helpers.isFluidSet(a)?(e=a,d=e.options):(d=c.helpers.mergeObject(g(),{}),e=new c.FluidSet(d));var j;if(a&&!c.helpers.isFluidSet(a))j=Array.isArray(a)?a:[a];else{var k=d.fluidClass.toString();k="."===k.slice(0,1)?k:"."+k,j=(b||document).querySelectorAll(k),b&&c.helpers.matchesSelector(b,k)&&(j=Array.prototype.slice.call(j),j.unshift(b))}for(var l=0;l<j.length;l++)null!==j[l]&&(d.updateOnPinchZoom&&e.attachGestureEvent(j[l]),e.updateSrc(j[l]));return d.lazyLoad&&!e.windowScrollEventBound&&e.attachScrollListener(),d.updateOnResize&&!e.windowResizeEventBound&&e.attachWindowResizer(),e}},"undefined"!=typeof window&&(c.onready=function(){function g(){var a;for(f=!0;a=c.shift();)a()}var a,b,c=[],d=document.documentElement.doScroll,e=d?/^loaded|^c/:/^loaded|c/,f=e.test(document.readyState);return document.addEventListener?(b=function(){document.removeEventListener("DOMContentLoaded",b,!1),g()},document.addEventListener("DOMContentLoaded",b,!1)):document.attachEvent&&(b=function(){/^c/.test(document.readyState)&&(document.detachEvent("onreadystatechange",b),g())},document.attachEvent("onreadystatechange",b)),a=d?function(b){window.self!=window.top?f?b():c.push(b):!function(){try{document.documentElement.doScroll("left")}catch(c){return setTimeout(function(){a(b)},50)}b()}()}:function(a){f?a():c.push(a)}}()),c.rgbToHex=function(a){var b=a.split(",");return b=b.map(function(a){return c.componentToHex(parseInt(a.replace(/\D/g,"")))}),b.join("")},c.componentToHex=function(a){var b=a.toString(16);return 1===b.length?"0"+b:b},c.getColorBrightness=function(a){if(!a)return 0;"#"===a.slice(0,1)&&(a=c.hexToRGB(a));var b=a.replace(/[^0-9,]+/g,"").split(","),d=parseInt(b[0],10),e=parseInt(b[1],10),f=parseInt(b[2],10);return Math.sqrt(d*d*.241+e*e*.691+f*f*.068)},c.applyAlphaToRGB=function(a,b){var c="rgba"!==a.slice(0,4),d=a.split(",");return d=d.map(function(a){return parseInt(a.replace(/\D/g,""),10)}),c?d.push(b):4===d.length&&(d[3]=b),"rgba("+d.join(", ")+")"},c.hexToRGB=function(a){function f(a){return(a+a).toString()}if(a)if("#"===a.slice(0,1))a=a.slice(1,a.length);else if("rgb"===a.slice(0,3))return a;var b=0,d=0,e=0;return 3===a.length?(b=parseInt(f(a.slice(0,1)),16),d=parseInt(f(a.slice(1,2)),16),e=parseInt(f(a.slice(2,3)),16)):6===a.length?(b=parseInt(a.slice(0,2),16),d=parseInt(a.slice(2,4),16),e=parseInt(a.slice(4,6),16)):c.helpers.warn("invalid hex color:",a),"rgb("+b+", "+d+", "+e+")"},c.getElementByXPathClassName=function(a){return document.querySelector("."+c.getXPathClass(a))},c.getElementImageByXPathClassName=function(a){return c.getElementImage(c.getElementByXPathClassName(a))},c.getElementTreeXPath=function(a){for(var b=[];a&&a.nodeType===Node.ELEMENT_NODE;a=a.parentNode){for(var c=0,d=a.previousSibling;d;d=d.previousSibling)d.nodeType!==Node.DOCUMENT_TYPE_NODE&&d.nodeName===a.nodeName&&++c;var e=(a.prefix?a.prefix+":":"")+a.localName,f=c?"["+(c+1)+"]":"";b.splice(0,0,e+f)}return b.length?"/"+b.join("/"):null},"function"==typeof define&&define.amd&&define("imgix",[],function(){return c})}).call(this);
